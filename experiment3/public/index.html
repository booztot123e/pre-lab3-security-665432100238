<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Experiment 3: Security Protection</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .container { max-width: 1000px; margin: 0 auto; }
        .comparison { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .test-case { 
            background: #f5f5f5; 
            padding: 20px; 
            border-radius: 8px; 
        }
        .vulnerable { border-left: 4px solid #ff6b6b; }
        .secure { border-left: 4px solid #51cf66; }
        input, textarea, button { 
            padding: 10px; 
            margin: 5px 0; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
            width: 100%; 
            box-sizing: border-box; 
        }
        button { background: #007bff; color: white; cursor: pointer; width: auto; }
        .result { 
            margin-top: 10px; 
            padding: 10px; 
            border-radius: 4px; 
            background: #e9ecef; 
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Experiment 3: ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</h1>
        
        <h2>‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö: ‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô</h2>
        
        <div class="comparison">
            <div class="test-case vulnerable">
                <h3>üö® ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà</h3>
                <p>‡∏ó‡∏î‡∏™‡∏≠‡∏ö login ‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà (port 3001)</p>
                
                <form id="vulnerableLogin">
                    <input type="text" placeholder="Username" value="admin'; --">
                    <input type="password" placeholder="Password" value="anything">
                    <button type="submit">Login (Vulnerable)</button>
                </form>
                
                <div class="result" id="vulnerableResult"></div>
            </div>
            
            <div class="test-case secure">
                <h3>‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô</h3>
                <p>‡∏ó‡∏î‡∏™‡∏≠‡∏ö login ‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô</p>
                
                <form id="secureLogin">
                    <input type="text" placeholder="Username" value="admin'; --">
                    <input type="password" placeholder="Password" value="anything">
                    <button type="submit">Login (Secure)</button>
                </form>
                
                <div class="result" id="secureResult"></div>
            </div>
        </div>
        
        <div class="test-case">
            <h3>üß™ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö Input Validation</h3>
            <p>‡∏•‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£</p>
            
            <form id="validationTest">
                <input type="text" id="testName" placeholder="‡∏ä‡∏∑‡πà‡∏≠ (‡∏•‡∏≠‡∏á XSS payload)">
                <textarea id="testComment" placeholder="‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô (‡∏•‡∏≠‡∏á script tag)" rows="3"></textarea>
                <button type="submit">‡∏ó‡∏î‡∏™‡∏≠‡∏ö Validation</button>
            </form>
            
            <div class="result" id="validationResult"></div>
            
            <h4>üí° Test Cases ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</h4>
            <ul>
                <li><code>&lt;script&gt;alert('test')&lt;/script&gt;</code></li>
                <li><code>' OR '1'='1</code></li>
                <li>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô 500 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</li>
                <li><code>javascript:alert('xss')</code></li>
                <li><code>&lt;img src=x onerror=alert(1)&gt;</code></li>
            </ul>
        </div>
        
        <div class="test-case">
            <h3>üìù ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï:</h3>
            <ol>
                <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏ï‡πà‡∏≠ SQL injection ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</li>
                <li>Input validation ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏î‡πâ‡∏ö‡πâ‡∏≤‡∏á?</li>
                <li>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á string concatenation ‡∏Å‡∏±‡∏ö prepared statements ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?</li>
                <li>HTML sanitization ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</li>
                <li>‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î?</li>
            </ol>
        </div>
    </div>

    <script>
        // Test vulnerable login (assuming server on port 3001 is running)
        document.getElementById('vulnerableLogin').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const username = e.target.querySelector('input[type="text"]').value;
            const password = e.target.querySelector('input[type="password"]').value;
            
            try {
                const response = await fetch('http://localhost:3001/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await response.json();
                document.getElementById('vulnerableResult').innerHTML = `
                    <div class="${data.success ? 'success' : 'error'}">
                        <strong>Vulnerable Server Response:</strong><br>
                        ${JSON.stringify(data, null, 2)}
                    </div>
                `;
            } catch (error) {
                document.getElementById('vulnerableResult').innerHTML = `
                    <div class="error">Error: ${error.message}<br>
                    <small>Make sure vulnerable server (port 3001) is running</small></div>
                `;
            }
        });
        
        // Test secure login
        document.getElementById('secureLogin').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = e.target.querySelector('input[type="text"]').value;
            const password = e.target.querySelector('input[type="password"]').value;
            
            try {
                const response = await fetch('/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await response.json();
                document.getElementById('secureResult').innerHTML = `
                    <div class="${data.success ? 'success' : 'error'}">
                        <strong>Secure Server Response:</strong><br>
                        ${JSON.stringify(data, null, 2)}
                    </div>
                `;
            } catch (error) {
                document.getElementById('secureResult').innerHTML = `
                    <div class="error">Error: ${error.message}</div>
                `;
            }
        });
        
        // Test validation
        document.getElementById('validationTest').addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('testName').value;
            const comment = document.getElementById('testComment').value;
            
            try {
                const response = await fetch('/comment', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, comment })
                });
                
                const data = await response.json();
                document.getElementById('validationResult').innerHTML = `
                    <div class="${data.success ? 'success' : 'error'}">
                        <strong>Validation Result:</strong><br>
                        ${JSON.stringify(data, null, 2)}
                        ${data.sanitized ? '<br><em>Content was sanitized for security</em>' : ''}
                    </div>
                `;
            } catch (error) {
                document.getElementById('validationResult').innerHTML = `
                    <div class="error">Error: ${error.message}</div>
                `;
            }
        });
    </script>
</body>
</html>